package pt.utl.ist.repox.dataProvider;import org.apache.log4j.Logger;import org.dom4j.DocumentException;import org.dom4j.DocumentHelper;import org.dom4j.Element;import pt.utl.ist.repox.util.ConfigSingleton;import java.io.IOException;import java.net.URL;import java.util.ArrayList;import java.util.List;/** * Created by IntelliJ IDEA. * User: Emanuel * Date: 11/Abr/2010 * Time: 11:53:20 */public class AggregatorEuropeana {    private static final Logger log = Logger.getLogger(AggregatorEuropeana.class);    private String id;    private String name;    private String nameCode;    private URL homePage;    private List<DataProviderEuropeana> dataProviders = new ArrayList<DataProviderEuropeana>();    /**     * Get the Identifier of the AggregatorEuropeana. The Identifier value is generated by the server side application. If     * an error occurs on the server side (e.g. "AggregatorEuropeana Already Exists"), the default value (-1L) is returned.     *     * @return - Long     */    public String getId() {        return id;    }    /**     * Set the Identifier of the AggregatorEuropeana. This method is used by the Server side application. A value set by the     * client side application is ignored.     *     * @param id - Long     */    public void setId(String id) {        this.id = id;    }    /**     * Get the Name of the AggregatorEuropeana     *     * @return - String     */    public String getName() {        return name;    }    /**     * Set the Name of the AggregatorEuropeana     *     * @param name - String     */    public void setName(String name) {        this.name = name;    }    /**     * Get the code associated to the AggregatorEuropeana. The NameCode is used by the Europeana server side application     * to generate a unique file identifier for harversted metadata.     *     * @return - String     */    public String getNameCode() {        return nameCode;    }    /**     * Set the code associated to the AggregatorEuropeana. The NameCode is used by the Europeana server side application     * to generate a unique file identifier for harversted metadata.     *     * @return - String     */    public void setNameCode(String nameCode) {        this.nameCode = nameCode;    }    /**     * Get the URL of the AggregatorEuropeana's Home Page     *     * @return URL     */    public URL getHomePage() {        return homePage;    }    /**     * Set the URL of the AggregatorEuropeana's Home Page     *     * @param homePage - URL     */    public void setHomePage(URL homePage) {        this.homePage = homePage;    }    /**     * Get the List of Providers belonging to this AggregatorEuropeana instance.     *     * @return -  List<DataProvider>     * @see {@link DataProvider}     */    public List<DataProviderEuropeana> getDataProviders() {        return dataProviders;    }    /**     * Set the List of Providers belonging to this AggregatorEuropeana instance.     *     * @param dataProviders - List<DataProvider>     * @see {@link DataProvider}     */    public void setDataProviders(List<DataProviderEuropeana> dataProviders)  {        this.dataProviders.addAll(dataProviders);    }    /**     * Add a Data Provider     *     * @param dataProvider - DataProvider     * @see {@link DataProvider}     */    public void addDataProvider(DataProviderEuropeana dataProvider)  {        dataProviders.add(dataProvider);    }    /**     * Generate an Id for Aggregator     * @param name     * @return     * @throws DocumentException     * @throws IOException     */    public static String generateId(String name) throws DocumentException, IOException {        String generatedIdPrefix = "";        for (int i = 0; (i < name.length() && i < 32); i++) {            if((name.charAt(i) >= 'a' && name.charAt(i) <= 'z')                    || (name.charAt(i) >= 'A' && name.charAt(i) <= 'Z')) {                generatedIdPrefix += name.charAt(i);            }        }        generatedIdPrefix += "r";        return generatedIdPrefix + generateNumberSufix(generatedIdPrefix);    }    private static int generateNumberSufix(String basename) throws DocumentException, IOException {        int currentNumber = 0;        String currentFullId = basename + currentNumber;        while(((DataManagerEuropeana)ConfigSingleton.getRepoxContextUtil().getRepoxManager().getDataManager()).getAggregator(currentFullId) != null) {            currentNumber++;            currentFullId = basename + currentNumber;        }        return currentNumber;    }    public AggregatorEuropeana() {    }    public AggregatorEuropeana(String id, String name, String nameCode, URL homePage, List<DataProviderEuropeana> dataProviders) {        this.id = id;        this.name = name;        this.nameCode = nameCode;        this.homePage = homePage;        this.dataProviders = dataProviders;    }    /**     * Create Element from aggregator information     * @return Document     */    public Element createElement(boolean writeDataProviders){        Element aggregatorNode = DocumentHelper.createElement("aggregator");        aggregatorNode.addAttribute("id", this.getId());        aggregatorNode.addElement("name").setText(this.getName());        if(this.getNameCode() != null) {            aggregatorNode.addElement("nameCode").setText(this.getNameCode());        }        if(this.getHomePage() != null) {            aggregatorNode.addElement("url").setText(this.getHomePage().toString());        }        if(writeDataProviders && this.getDataProviders() != null){            for (DataProviderEuropeana dataProviderEuropeana : this.getDataProviders()) {                aggregatorNode.add(dataProviderEuropeana.createElement(true));            }        }        return aggregatorNode;    }}